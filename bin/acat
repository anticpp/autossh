#!/usr/bin/python3

'''
Usage:
    acat            - Cat all hosts.
    acat [target]   - Cat target host.
'''

import os
import sys
import yaml
import autossh.tools.lookup

config_file = os.path.expanduser("~/.config/autossh/config.yaml")

target = ""
if len(sys.argv)>=2:
    target = sys.argv[1]

## Load configure file
f = open(config_file)
c = yaml.safe_load(f)
f.close()

if len(target)>0:
    lu = autossh.tools.lookup.Lookup()
    ok, n = lu.loadFromFile(os.path.expanduser(c["hosts"]["file"]))
    if not ok:
        print("[Warning] Load host entry file", c["hosts"]["file"], "fail. You can touch one.")
    ok, info = lu.get(target)
    if not ok:
        print("Target not found: '%s' "%(target) )
        sys.exit(1)
    print(info)
else:
    content = ""
    try:
        f = open(os.path.expanduser(c["hosts"]["file"]))
        content = f.read()
        f.close()
    except IOError as e:
        print("[Warning] Load host entry file", c["hosts"]["file"], "fail. You can touch one.")
    print(content)


